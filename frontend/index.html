<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VERAE B2C MVP</title>
    <style>
      body { font-family: Arial, sans-serif; max-width: 840px; margin: 24px auto; padding: 0 12px; }
      h1 { margin-bottom: 8px; }
      .grid { display: grid; grid-template-columns: repeat(2, minmax(180px, 1fr)); gap: 10px; }
      label { display: flex; flex-direction: column; font-size: 14px; }
      input { margin-top: 4px; padding: 8px; }
      .required::after { content: ' *'; color: #cc0000; }
      .hint { color: #666; font-size: 13px; margin: 10px 0; }
      button { margin-top: 14px; padding: 10px 16px; margin-right: 8px; }
      .error { color: #c00; margin: 10px 0; }
      .risk-bar { height: 12px; background: #eee; border-radius: 6px; overflow: hidden; margin: 8px 0; }
      .risk-fill { height: 100%; background: #6b8; transition: width 0.3s; }
      .tier-labels { font-size: 12px; color: #666; }
      .result-block { margin: 16px 0; }
      .explanations-block { margin-top: 16px; }
      .explanations-block ul { margin: 8px 0; padding-left: 20px; }
      [data-screen] { display: block; }
      [data-screen][hidden] { display: none; }
    </style>
  </head>
  <body>
    <div id="app">
      <div data-screen="login" hidden>
        <h1>Вход</h1>
        <form id="loginForm">
          <label>Email <input type="email" id="loginEmail" required /></label>
          <label>Пароль <input type="password" id="loginPassword" required /></label>
          <p id="loginError" class="error"></p>
          <button type="submit">Войти</button>
          <a href="#register">Регистрация</a>
        </form>
      </div>

      <div data-screen="register" hidden>
        <h1>Регистрация</h1>
        <form id="registerForm">
          <label>Email <input type="email" id="registerEmail" required /></label>
          <label>Пароль (не менее 8 символов) <input type="password" id="registerPassword" minlength="8" required /></label>
          <p id="registerError" class="error"></p>
          <button type="submit">Зарегистрироваться</button>
          <a href="#login">Вход</a>
        </form>
      </div>

      <div data-screen="form" hidden>
        <h1>VERAE B2C MVP</h1>
        <button type="button" id="logoutBtn">Выйти</button>
        <a href="#list">Мои анализы</a>
        <p class="hint">
          Заполнено обязательных: <span id="progress">0/8</span>
          (альтернатива: <code>BMXBMI</code> или <code>BMXHT</code> + <code>BMXWT</code>)
        </p>
        <form id="riskForm" class="grid"></form>
        <p id="formError" class="error"></p>
        <button type="button" id="submitBtn">Анализировать</button>
        <button type="button" id="openLastResultBtn" hidden>Открыть последний результат</button>
      </div>

      <div data-screen="status" hidden>
        <h1>Обработка</h1>
        <p id="statusText">Загрузка…</p>
        <p id="statusError" class="error"></p>
        <p><a href="#form">Отмена</a></p>
      </div>

      <div data-screen="result" hidden>
        <h1>Результат анализа</h1>
        <p id="resultError" class="error"></p>
        <div id="resultContent"></div>
        <p><a href="#form">Создать новый анализ</a> <a href="#list">Мои анализы</a></p>
      </div>

      <div data-screen="list" hidden>
        <h1>Мои анализы</h1>
        <p id="listError" class="error"></p>
        <div id="listContent"></div>
        <p><a href="#form">Новый анализ</a></p>
      </div>
    </div>
    <script type="module" src="./app.mjs"></script>
  </body>
</html>
